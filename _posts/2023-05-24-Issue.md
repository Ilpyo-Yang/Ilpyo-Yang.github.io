---
title: Trouble Shooting ğŸ
author: Rosie Yang
date: 2023-05-24
category: special
layout: post
---

+ [JPAQueryFactory ì„¤ì • ì´ìŠˆ](#jpaqueryfactory-ì„¤ì •-ì´ìŠˆ)

### JPAQueryFactory ì„¤ì • ì´ìŠˆ
> Spring boot 3.x, Querydsl 5.0.0, Java 17

<br>

**ì´ìŠˆì‚¬í•­**  
Spring Boot 3.x ë²„ì „ì—ì„œëŠ” javaxê°€ ì•„ë‹Œ ```jakarta persistence dependency```ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ```build.gradle```ì„ ë³€ê²½í•˜ê³  EntityManager importë¥¼ ë³€ê²½ í›„ì— ```JPAQueryFactory```ì— ë“±ë¡í–ˆìŒì—ë„ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•ŠëŠ” ëª¨ìŠµì„ ë³´ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.  
ì—¬ì „íˆ ```JPAQueryFactory```ëŠ” javax entityë§Œì„ ìš”êµ¬í•˜ëŠ” ì´ìŠˆê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

![20230612_192728.png](/assets/gitbook/post_images/issue/20230612_192728.png)

<span style="background-color:#DCFFE4; margin-right:5px">ì™œ jakartaë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•˜ì—¬</span>  
ì˜¤ë¼í´ ì¬ë‹¨ì—ì„œ ì´í´ë¦½ìŠ¤ë¡œ ```JavaEE``` ê¸°ìˆ  ì´ì „ê³¼ í•¨ê»˜ ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ ```javax.*``` ëŒ€ì‹  ë‹¤ë¥¸ ëª…ì¹­ì¸ ```jakarta.*```ë¥¼ ì‚¬ìš©í•˜ëŠ” ```JakartaEE```ê°€ ë°˜ì˜ëœ Spring bootê°€ ë¦´ë¦¬ì¦ˆë˜ì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.  

<br>

**í•´ê²°ë°©ë²•**  
ë¨¼ì € Querydsl ì‚¬ìš©ì„ ìœ„í•œ ì„¤ì • ë¶€ë¶„ì„ ë³´ë©´, ë³€ê²½ëœ jakartaë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  implementaionì—ë„ jakartaë¥¼ ëª…ì‹œí•´ë‘ì—ˆìŠµë‹ˆë‹¤. ì´ ë¶€ë¶„ì€ ë¬¸ì œê°€ ì—†ê³  ë¹Œë“œë‚˜ Q class ìƒì„±ì—ë„ ì´ìƒì´ ì—†ì—ˆìŠµë‹ˆë‹¤.  
ì—ëŸ¬ë¥¼ ì‚´í´ë³´ë©´ EntityManager ì¸ì‹ë¬¸ì œê°€ ì œì¼ ì»¸ê¸° ë•Œë¬¸ì— [JPAQueryFactory](https://github.com/querydsl/querydsl/blob/master/querydsl-jpa/src/main/java/com/querydsl/jpa/impl/JPAQueryFactory.java)ê°€ ì™œ ì¸í…”ë¦¬ì œì´ì—ì„œ ì˜ì¡´ì„± ì£¼ì…ì´ ì œëŒ€ë¡œ ë˜ì§€ ì•Šì•˜ëŠ”ì§€ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤.  
```yml
// querydsl
implementation "com.querydsl:querydsl-jpa:${queryDslVersion}:jakarta"
annotationProcessor "com.querydsl:querydsl-apt:${queryDslVersion}:jakarta"
annotationProcessor "jakarta.annotation:jakarta.annotation-api"
annotationProcessor "jakarta.persistence:jakarta.persistence-api"
```
ìœ„ì˜ ì½”ë“œì™€ ê°™ì´ ```classifier```ë¡œ ë²„ì „ ë’¤ì— ```:jakarta``` ì„¤ì •ì„ í•´ì£¼ì§€ ì•Šì•„ ìƒê¸´ ë¬¸ì œì˜€ìŠµë‹ˆë‹¤. ì´ì „ ì½”ë“œì— ```classifier```ë¥¼ ì¶”ê°€í•´ì£¼ì—ˆì§€ë§Œ, ì¸ì‹ì„ ì œëŒ€ë¡œ í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. gradle ë¹Œë“œ, clean, import ì¬ì‘ì„±, cache ì‚­ì œ ë“± ë°©ë²•ì„ ì‚¬ìš©í–ˆì§€ë§Œ í•´ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
<span style="background-color:#fff5b1; margin-right:5px">ê²°êµ­ build.gradle íŒŒì¼ì„ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ìƒì„±</span>í•˜ëŠ” ê²ƒìœ¼ë¡œ í•´ê²°í–ˆìŠµë‹ˆë‹¤.  

[ì¸í…”ë¦¬ì œì´ ë¬¸ì˜](https://youtrack.jetbrains.com/issue/IDEA-255594/Intellij-keeps-old-dependencies)ì—ì„œë„ ì•Œ ìˆ˜ ìˆë“¯ì´ ê¾¸ì¤€íˆ ê°™ì€ ì´ìŠˆê°€ ë°œìƒí•˜ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì „ dependencyê°€ í”„ë¡œì íŠ¸ ë‚´ì— ì–´ë–¤ sourceì— ì˜í–¥ì„ ë¯¸ì¹˜ê³  ìˆê¸° ë•Œë¬¸ì¸ ê±¸ë¡œ ì¶”ì¸¡ë©ë‹ˆë‹¤.  
> Facing issue with dependency ,as when removed/updated a dependency it still persisted with older version . Even Settings>Maven> Always update snapshots did not work here.
Had to delete .idea and .iml files and reimport the project. Quite a lot of time and effort went into getting a workaround for this.
This is a very basic use case where developers need to keep updating the maven dependencies.
Having to spend time and money on ultimate edition seems wasteful at the moment.

ì´ë ‡ë‹¤ í•  ëšœë ·í•œ ëŒ€ì•ˆì€ ì—†ì§€ë§Œ IntelliJë¥¼ ë›°ì–´ë„˜ëŠ” íˆ´ë„ ì—†ê¸°ì— ì—¬ëŸ¬ ê°€ëŠ¥ì„±ì„ ë‘ê³  ì‚´í´ë³´ëŠ” ê²ƒì´ ì œì¼ ì¢‹ì€ ë°©ë²•ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

<br>

**ê²°ê³¼**  
```jakarta.persistence.EntityManager```ë¡œë„ ```JPAQueryFactory``` ë¹ˆ ì£¼ì… ë° ìƒì„±ì— ë¬¸ì œê°€ ì—†ìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. InitDB testë„ í†µê³¼í–ˆìŠµë‹ˆë‹¤! 
ì •ìƒì ì¸ ì‘ë™ì„ í™•ì¸í•œ ë’¤ì— ì½”ë“œë¥¼ ì‚´í´ë³´ë©´ java íŒŒì¼ì€ ```javax```ë¥¼ ì—¬ì „íˆ ìš”êµ¬í•˜ê³  ìˆì§€ë§Œ class íŒŒì¼ ìƒì„±ì‹œì— ```jakarta``` íƒ€ì…ì˜ EntityManagerë¡œ ë°›ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

![20230613_150127.png](/assets/gitbook/post_images/issue/20230613_150127.png)

****
[ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0 ìœ¼ë¡œ ì „í™˜](https://post.dooray.io/we-dooray/tech-insight-ko/back-end/4173/)  
[spring boot 3.0](https://github.com/querydsl/querydsl/issues/3493)  
[Intellij keeps old dependencies](https://youtrack.jetbrains.com/issue/IDEA-255594/Intellij-keeps-old-dependencies)  

<br><br>

<div style="padding:3px; margin:200px 0;"></div>   