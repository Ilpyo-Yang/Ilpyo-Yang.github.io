---
title: JPA
author: Rosie Yang
date: 2023-04-15T00:00:00.000Z
category: backend
---

# JPA

### JPAì— ëŒ€í•˜ì—¬

JPAëŠ” Java Persistence APIë¡œ ìë°” í”Œë«í¼ SEì™€ ìë°” í”Œë«í¼ EEë¥¼ ì‚¬ìš©í•˜ëŠ” ì‘ìš©í”„ë¡œê·¸ë¨ì—ì„œ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì˜ ê´€ë¦¬(ORM ê¸°ìˆ  í‘œì¤€)ë¥¼ í‘œí˜„í•˜ëŠ” ìë°” APIì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ ORM(Object Relational Mapping)ì´ë€ ê°ì²´ì™€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ê´€ê³„ë¥¼ ë§¤í•‘í•´ì£¼ëŠ” ë„êµ¬ë¡œ ìë°” ì™¸ ì–¸ì–´ì—ì„œëŠ” node.jsì—ì„œì˜ `Sequelize`, python ê¸°ë°˜ Djangoì—ì„œ ì§€ì›í•˜ëŠ” `Django ORM` ë“±ì´ ìˆìŠµë‹ˆë‹¤.

![jpa\_operation.png](../assets/gitbook/post\_images/jpa/jpa\_opertaion.png)

JPAëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ JDBC ì‚¬ì´ì—ì„œ ë™ì‘í•˜ë©° SQL ì‘ì„±ìœ¼ë¡œ ì¸í•œ ê°œë°œì‹œê°„ì„ ë‹¨ì¶•í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤. JPAë¥¼ ì‚¬ìš©í•˜ë©´ Entity ë¶„ì„í•˜ê³  SQL ìƒì„±í•œ ë’¤, JDBC API ì‚¬ìš©í•˜ê³  íŒ¨ëŸ¬ë‹¤ì„ì˜ ë¶ˆì¼ì¹˜ê¹Œì§€ í•´ê²°í•´ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

JPAëŠ” íŒ¨ëŸ¬ë‹¤ì„ì˜ ë¶ˆì¼ì¹˜ë¥¼ ì–´ë–»ê²Œ í•´ê²°í• ê¹Œ?\
íŒ¨ëŸ¬ë‹¤ì„ì˜ ë¶ˆì¼ì¹˜ëŠ” ê°ì²´ì™€ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ì´ì˜ ë¶ˆì¼ì¹˜ ì˜ë¯¸í•©ë‹ˆë‹¤. ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì—ëŠ” í…Œì´ë¸”ë¡œ ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ê³  ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì€ ê°ì²´ ë‹¨ìœ„ë¡œ ìƒì†, ë‹¤í˜•ì„± ê°œë…ì„ ê°€ì§€ê³  ê´€ë¦¬í•©ë‹ˆë‹¤. ëŒ€í‘œì ì¸ ë¶ˆì¼ì¹˜ë¡œ ì‚¬ë¡€ë“¤ì€ ìƒì†, ì—°ê´€ê´€ê³„, ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰, ì‹ë³„ì ë“±ì´ ìˆìŠµë‹ˆë‹¤. JPAì—ì„œëŠ” ë‹¤ì–‘í•œ ë§¤í•‘ ì–´ë…¸í…Œì´ì…˜ê³¼ ë§¤í•‘ ì„¤ì •, ê·¸ë¦¬ê³  ì§€ì—°ë¡œë”©, ì¦‰ì‹œë¡œë”©ì„ ì´ìš©í•´ íŒ¨ëŸ¬ë‹¤ì„ì˜ ë¶ˆì¼ì¹˜ë¥¼ ìµœì†Œí™”í•˜ê³  ìˆìŠµë‹ˆë‹¤.

\


**JPA ì„±ëŠ¥ ìµœì í™” ê¸°ëŠ¥**\
1ì°¨ ìºì‹œì™€ ë™ì¼ì„± ë³´ì¥í•©ë‹ˆë‹¤. ê°™ì€ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ê°™ì€ ì—”í‹°í‹°ë¥¼ ë°˜í™˜í•˜ê³  `Read Commit` ê²©ë¦¬ìˆ˜ì¤€ì—ì„œë„ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ `Repeatable Read`ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.\
íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°ì„ ì œê³µí•©ë‹ˆë‹¤. íŠ¸ëœì­ì…˜ì´ ëë‚  ë•Œê¹Œì§€ Insert SQLì„ ëª¨ì•„ì„œ í•œ ë²ˆì— Commit ì²˜ë¦¬í•©ë‹ˆë‹¤.\
ì§€ì—°ë¡œë”©ê³¼ ì¦‰ì‹œë¡œë”©ì„ ì§€ì›í•©ë‹ˆë‹¤. ì—°ê´€ëœ ê°ì²´ê¹Œì§€ ë¯¸ë¦¬ ì¡°íšŒí•˜ëŠ” ê²ƒì„ ì¦‰ì‹œë¡œë”©ì´ë¼ê³  í•©ë‹ˆë‹¤. ë°˜ë©´, ì§€ì—°ë¡œë”©ì€ ê°ì²´ê°€ ì‹¤ì œ ì‚¬ìš©ë  ë•Œ ë¡œë”©ë˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

\


**ë°ì´í„° ì¤‘ì‹¬ ì„¤ê³„ì™€ ì—”í‹°í‹° ì„¤ê³„ì˜ ì°¨ì´ì **\
ë°ì´í„° ì¤‘ì‹¬ ì„¤ê³„ëŠ” í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ë¥¼ ê°ì²´ì— ê·¸ëŒ€ë¡œ ê°€ì§€ê³  ì˜¤ëŠ” ë°©ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ì ¸ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ê²Œ ë˜ë©´, ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ì´ ë¶ˆê°€ëŠ¥í•´ì§€ê³ , ì°¸ì¡°ê°€ ì—†ì–´ UMLë„ ì˜ëª» ì‘ì„±ë©ë‹ˆë‹¤.\
ë”°ë¼ì„œ ë¨¼ì € ìë°” ê°ì²´ì¸ ì—”í‹°í‹°ë¥¼ ì„¤ê³„í•˜ê³  í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ì™¸ë˜í‚¤ê°€ ì•„ë‹Œ ì°¸ì¡°í•  í‚¤ì˜ ê°’ì„ ê°€ì§€ê³  ì™€ì„œ í•˜ë‚˜ì˜ ì»¬ëŸ¼

***

[Spring Data JPA - Reference Documentation](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/)

\
\


### ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(persistence context)

**JPAì˜ ëª¨ë“  ê¸°ëŠ¥ì€ Transaction ì•ˆì—ì„œ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.**\
ì´ëŠ” JPAê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(persistence context)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—”í‹°í‹°ì˜ ìƒíƒœë¥¼ ì¶”ì í•˜ê³ , ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ í•„ìš”í•©ë‹ˆë‹¤. ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” JPAì—ì„œ ì—”í‹°í‹° ê°ì²´ë¥¼ ê´€ë¦¬í•˜ëŠ” ë©”ëª¨ë¦¬ ì˜ì—­ì´ë©°, ì—”í‹°í‹°ì˜ ìƒíƒœë¥¼ ì¶”ì í•˜ê³  ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•©ë‹ˆë‹¤. íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ ì¼ê´€ì„±ì„ ìœ ì§€í•  ìˆ˜ ì—†ê²Œ ë˜ì–´, ë°ì´í„° ë¶ˆì¼ì¹˜ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œì¨ 1ì°¨ ìºì‹œì—ì„œ ì¡°íšŒí•œ ë’¤, ì—†ìœ¼ë©´ DB ì¡°íšŒí•˜ê³  1ì°¨ ìºì‹œì— ë°˜ì˜í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ìš”ì²­ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì¦‰, 1ì°¨ ìºì‹œë¡œ `Repeatable Read` ë“±ê¸‰ì˜ íŠ¸ëœì­ì…˜ ê²©ë¦¬ìˆ˜ì¤€ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì°¨ì›ì—ì„œ í•œ íŠ¸ëœì­ì…˜ ì•ˆì— ìˆ˜í–‰í•˜ë©°, ë§¤ë²ˆ ì‚¬ìš©ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í° ì„±ëŠ¥ìƒì˜ ì´ì ì€ ì—†ì§€ë§Œ, í•œ íŠ¸ëœì­ì…˜ì´ ê¸¸ê³  ë°˜ë³µì¡°íšŒê°€ ë§ë‹¤ë©´ 1ì°¨ ìºì‹œë¥¼ ì´ìš©í•œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ íš¨ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
(ì°¸ê³ ë¡œ ëª¨ë“  ê³ ê°ì´ ê°™ì€ ìºì‹œë¡œ ì„±ëŠ¥ì  íš¨ê³¼ë¥¼ ë³´ëŠ” ê²ƒì€ ì´ì™€ ë³„ê°œë¡œ 2ì°¨ ìºì‹œë¼ê³  í•©ë‹ˆë‹¤.)

```java
EntityManager em = emf.createEntityManager();
EntityTransaction transaction = em.getTransaction();
transaction.begin();

em.persist(memberA);
em.persist(memberB);

transaction.commit();   

// em.persist(memberA); ì²« ë²ˆì§¸ SQLë§Œ ìƒì„±ë˜ì„œ ì¡°íšŒí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
// ì´í›„ ë‚´ìš©ì€ 1ì°¨ ìºì‹œì—ì„œ ì¡°íšŒí•˜ê¸° ë•Œë¬¸

em.detach(member);  // ì¤€ì˜ì†, ì˜ì†ì„± ì»¨í…ŒìŠ¤íŠ¸ì—ì„œ ë¶„ë¦¬
em.remove(member);  // ê°ì²´ë¥¼ ì‚­ì œí•œ ìƒíƒœ
```

ì¤€ì˜ì† ìƒíƒœë€?\
JPAê°€ ê´€ë¦¬í•˜ëŠ” ìƒíƒœì¸ 1ì°¨ ìºì‹œì— ìˆëŠ” ìƒíƒœëŠ” ì˜ì†ì„± ìƒíƒœë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°˜ë©´, ì¤€ì˜ì† ìƒíƒœëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¶„ë¦¬ëœ ê²ƒìœ¼ë¡œ JPAê°€ ê´€ë¦¬í•˜ëŠ” ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤. ë”°ë¼ì„œ í•­ìƒ ë³€ê²½ ê°ì§€ë¥¼ ì‚¬ìš©í•´ì„œ entityë¥¼ ê´€ë¦¬í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. ì‹¤ë¬´ì—ì„œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ íŠ¹ì • í…Œì´ë¸”ì— ëŒ€í•œ ì¼ì‹œì ì¸ ë³€ê²½ì´ í•„ìš”í•œ ê²½ìš°, ì¤€ì˜ì† ìƒíƒœë¥¼ ì‚¬ìš©í•˜ì—¬ ì¼ì‹œì  ë³€ê²½ í›„ ë˜ëŒë¦¬ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.

\


#### ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ì´ì 

1ì°¨ ìºì‹œë§Œì„ ì‚¬ìš©í•˜ë©°, ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ì¡°íšŒì‹œ ê°™ì€ ê°ì²´ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤ëŠ” ì ì—ì„œ ë™ì¼ì„±ì„ ë³´ì¥í•´ì¤ë‹ˆë‹¤. íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸°ì§€ì—°ìœ¼ë¡œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í”ŒëŸ¬ì‹œí•˜ê¸° ì „ê¹Œì§€ ë°ì´í„°ë² ì´ìŠ¤ ë½ì´ ê±¸ë¦¬ëŠ” ì‹œê°„ì„ ìµœì†Œí™”í•©ë‹ˆë‹¤. ì§€ì—°ë¡œë”©ì„ ì´ìš©í•´ì„œ ì—°ê´€ê´€ê³„ë¥¼ íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜ë¥¼ ê°ì†Œì‹œí‚µë‹ˆë‹¤. ê·¸ë¦¬ê³  ë³€ê²½ê°ì§€(dirty check)ë¥¼ í•˜ê¸° ë•Œë¬¸ì— ìŠ¤ëƒ…ìƒ· ì •ë³´ì™€ ë°”ë€ entity ì •ë³´ë¥¼ ë¹„êµí•´ì„œ ë³€ê²½ ë¶€ë¶„ì„ ì»¤ë°‹ì‹œì— ì—…ë°ì´íŠ¸í•´ì¤ë‹ˆë‹¤.

ì“°ê¸° ì§€ì—° SQL ì €ì¥ì†ŒëŠ” ì™œ í•„ìš”í• ê¹Œ?\
ì“°ê¸° ì§€ì—°ì€ í•œ íŠ¸ëœì­ì…˜ì—ì„œ ì¼ì–´ë‚˜ëŠ” update, save ì¿¼ë¦¬ë¥¼ ê°€ì§€ê³  ìˆë‹¤ê°€ ìµœì¢…ì ìœ¼ë¡œ commitì´ ì¼ì–´ë‚˜ëŠ” ì‹œì ì— í•œ ë²ˆì— DBì— ë°˜ì˜í•˜ëŠ” ê²ƒì„ ë§í•©ë‹ˆë‹¤. Persistance StorageëŠ” ì´ëŸ° ì“°ê¸° ì§€ì› ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ Persistance Context í•˜ì— ê´€ë¦¬ë˜ê³  ìˆë˜ entityì˜ ë³€í™”ë“¤ì„ ê°ì§€, ì¶”ì í•˜ê³  ì´ë¥¼ Persistance Storageì— ë°˜ì˜í•œ ë’¤ ìµœì¢…ì ìœ¼ë¡œ DBì— ë°˜ì˜í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

í”ŒëŸ¬ì‹œê°€ ë­˜ê¹Œ?\
ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë³€ê²½ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ëŠ” ê²ƒì„ ë§í•©ë‹ˆë‹¤. ì»¤ë°‹ì´ë‚˜ ì¿¼ë¦¬ ì‹¤í–‰ì‹œ ìë™ìœ¼ë¡œ í”ŒëŸ¬ì‹œê°€ ë°œìƒí•˜ë©°(`FlushModeType.AUTO`, ê¸°ë³¸ê°’), ì“°ê¸° ì§€ì—° SQL ì €ì¥ì†Œì˜ ì¿¼ë¦¬ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì „ì†¡í•©ë‹ˆë‹¤. ì§ì ‘ í˜¸ì¶œí•˜ëŠ” ê²½ìš°ì—ëŠ” `em.flush()`ë¥¼ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”ŒëŸ¬ì‹œ ìì²´ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¹„ìš°ì§€ ì•Šê³  ë³€ê²½ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë™ê¸°í™”í•©ë‹ˆë‹¤.\
ì°¸ê³ ë¡œ JPAëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë§ì¶”ê±°ë‚˜ ë™ì‹œì„± ê´€ë ¨ëœ ê²ƒì„ ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ëœì­ì…˜ì— ìœ„ì„í•©ë‹ˆë‹¤.

***

[ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë° - ê¸°ë³¸í¸](https://www.inflearn.com/course/ORM-JPA-Basic/dashboard)\
[Object Persistence with JPA](https://thistechnologylife.com/object-persistence-with-jpa/)\
[\[JPA\] ì¤€ì˜ì† ìƒíƒœì™€ ë³€ê²½ ê°ì§€](https://velog.io/@wogud7587/JPA-%EC%A4%80%EC%98%81%EC%86%8D-%EC%83%81%ED%83%9C%EC%99%80-%EB%B3%80%EA%B2%BD-%EA%B0%90%EC%A7%80)

\
\


### ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìë™ìƒì„±

JPAëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ì£¼ë„ë¡ `ddl-auto` ì˜µì…˜ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜µì…˜ì˜ ì¢…ë¥˜ëŠ” `create`, `create-drop`, `update`, `none`, `validate` ì¢…ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤. ì£¼ë¡œ ê°œë°œí™˜ê²½ì´ë‚˜ í…ŒìŠ¤íŠ¸ ì„œë²„ì—ì„œëŠ” `update`ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ê³  ì‹¤ì„œë²„ì—ì„œëŠ” ì ˆëŒ€ ì‚¬ìš©í•˜ë©´ ì•ˆë©ë‹ˆë‹¤. ì£¼ë¡œ ìš´ì˜ì„œë²„ì—ì„œëŠ” `validate`ë‚˜ `none`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. `validate`ëŠ” ì—”í‹°í‹°ì™€ í…Œì´ë¸”ì´ ì •ìƒ ë§¤í•‘ë˜ì—ˆëŠ”ì§€ë§Œ í™•ì¸í•©ë‹ˆë‹¤. `none`ì´ë¼ëŠ” ê°œë…ì€ ì‹¤ì œ ì—†ê³ , ì£¼ì„ì²˜ë¦¬í•˜ëŠ” ê²ƒê³¼ ë™ì¼í•œ íš¨ê³¼ë¥¼ ê°–ìŠµë‹ˆë‹¤.

```yml
jpa:
  hibernate:
    ddl-auto: create
```

DDL ìƒì„±ê¸°ëŠ¥ì€ DDLì„ ìë™ ìƒì„±í•  ë•Œë§Œ ì‚¬ìš©ë˜ê³  JPAì˜ ì‹¤í–‰ë¡œì§ì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¦‰ `validation` ìš©ë„ë¡œ ì‚¬ìš©í•˜ê¸°ì— ì¢‹ìŠµë‹ˆë‹¤.

\
\


### ì—”í‹°í‹° ë§¤í•‘

**@Entity, @Table**

```java
@Entity
@Table(name="TABLE", schema="NAME", 
        uniqueConstraints={@UniqueConstraint(name="unique_pid", columnNames="PersonalId")})
public class Table {
    // Entity ì†ì„± ìƒëµ    
}
```

**@Column**\
`@Column(name="location", length=20, nullable=false)`\
unique ì œì•½ì—¬ë¶€ë„ ê±¸ ìˆ˜ ìˆì§€ë§Œ, unique ì œì•½ì˜ ì´ë¦„ì„ ì„¤ì •í•˜ê¸° ì–´ë µê¸° ë•Œë¬¸ì— `@Table` ìœ„ì— ì½”ë“œì²˜ëŸ¼ ì§ì ‘ ì„¤ì •í•´ì£¼ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.\
nameì„ ì„¤ì •í•  ë•ŒëŠ” ë³„ë„ ì§€ì •ì´ ì—†ì´ë„ ìŠ¤í”„ë§ë¶€íŠ¸ì—ì„œëŠ” ìë°”ì˜ `Carmel Case` ì´ë¦„ì„ `Snake Case`ë¡œ ë³€ê²½í•´ì„œ ìë™ ë§¤í•‘í•  ìˆ˜ ìˆëŠ”ë°, ì§ì ‘ ì½”ë“œë¡œ ì„¤ì •ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. `spring.jpa.hibernate.naming.physical-strategy` ì†ì„±ì„ `org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl` í´ë˜ìŠ¤ë¡œ ì„¤ì •í•˜ê³ , `spring.jpa.hibernate.naming.physical-strategy` ì†ì„±ì„ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ìŠ¤ë„¤ì´í¬ ì¼€ì´ìŠ¤ë¡œ ë³€í™˜í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

```properties
// ì§ì ‘ êµ¬í˜„ì‹œ -> ì˜¤ë²„ë¼ì´ë“œ
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
// ìë™ êµ¬í˜„ì‹œ ì„¤ì •
spring.jpa.properties.hibernate.physical_naming_strategy=com.example.SnakeCaseNamingStrategy
```

**@Enumerated**\
`@Enumerated(value = EnumType.STRING)`\
ê¸°ë³¸ê°’ì¸ EnumType.ORDINALì„ ì‚¬ìš©í•˜ë©´ enum ìˆœì„œë¥¼ ì €ì¥í•©ë‹ˆë‹¤.

**@Temporal**\
ë‚ ì§œ íƒ€ì…ì„ ë§¤í•‘í•  ë•Œ ì‚¬ìš©ë˜ë©°, TemporalTypeì€ date, time, timestampë¡œ ë‚˜ë‰©ë‹ˆë‹¤. Date, Calendar ë§¤í•‘ì— ì‚¬ìš©í•˜ë©°, `LocalDateTime`, `LocatlDate`ì˜ ê²½ìš°ì—ëŠ” ìƒëµì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

**@Transient**\
íŠ¹ì • í•„ë“œë¥¼ ì»¬ëŸ¼ì— ë§¤í•‘í•˜ì§€ ì•Šì„ ê²½ìš°ë¡œ ë©”ëª¨ë¦¬ ìƒì— ì–´ë–¤ ê°’ì„ ì„ì‹œë¡œ ì €ì¥í•˜ê³  ì‹¶ì€ ê²½ìš°ì— ì‚¬ìš©ë©ë‹ˆë‹¤.

**@Lob**\
Large Objectì˜ ì¤„ì„ë§ë¡œ ìŠ¤í”„ë§ì´ ì¶”ë¡ í•˜ì—¬ ì–´ë–¤ íƒ€ì…ìœ¼ë¡œ ì €ì¥í• ì§€ë¥¼ íŒë‹¨í•  ë•Œ ì‚¬ìš©í•˜ë©°, ë¬¸ìëŠ” `BLOB`ìœ¼ë¡œ ë‚˜ë¨¸ì§€ëŠ” `CLOB` íƒ€ì…ê³¼ ë§¤í•‘í•©ë‹ˆë‹¤.

**@Id**\
ê¸°ë³¸í‚¤ë¥¼ ì§ì ‘ ë§¤í•‘í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©ë©ë‹ˆë‹¤.

**@GeneratedValue**\
ê¸°ë³¸í‚¤ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ì£¼ëŠ” ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ `GenerationType` ì „ëµì€ 4ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.

* `IDENTITY`
  * ê¸°ë³¸í‚¤ ìƒì„±ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ìœ„ì„í•˜ëŠ” ì „ëµì…ë‹ˆë‹¤. `em.persist()` ì‹œì ì— ì¦‰ì‹œ insertí•˜ê³  db ì‹ë³„ìë¥¼ ì¡°íšŒí•´ì˜µë‹ˆë‹¤.
  * MySQLì€ `AUTO_INCREMENT` ê°’ì„ ì €ì¥í•˜ê³  ë‚˜ì„œ ê¸°ë³¸í‚¤ë¥¼ êµ¬í•  ìˆ˜ ìˆì„ ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
  * ì´ ì „ëµì—ì„œëŠ” íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°ì´ ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
* `SEQUENCE`
  * `@SequenceGenerator` ì‹œí€€ìŠ¤ë¥¼ ì´ìš©í•´ì„œ ê¸°ë³¸í‚¤ë¥¼ ìƒì„±í•˜ëŠ”ë°, ì‹œí€€ìŠ¤ë¥¼ ì§€ì›í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
* `TABLE`
  * í‚¤ ìƒì„±ìš© í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤.
* `AUTO`
  * ë°©ì–¸ì— ë”°ë¼ ìë™ì§€ì •ë˜ë©°, ê¸°ë³¸ê°’ì…ë‹ˆë‹¤.

`GenerationType` ì „ëµì„ ì‚¬ìš©í•  ë•ŒëŠ” ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. Hibernate ë²„ì „ë³„ ì „ëµì— ë”°ë¼ ê¸°ë³¸í‚¤ ìë™ ìƒì„±ì´ ì„¤ì • ê°’ê³¼ ë‹¤ë¥´ê²Œ ì ìš©ë  ìˆ˜ ìˆë‹¤ëŠ” ë¬¸ì œë¥¼ ì‹¤ì œ ê²ªì€ ì ì´ ìˆëŠ”ë° ì˜ ì •ë¦¬ëœ [ë¸”ë¡œê·¸ ê¸€](https://jojoldu.tistory.com/295)ì´ ìˆì–´ì„œ ì¶”ê°€í•©ë‹ˆë‹¤.

***

[\[JPA\] ê¸°ë³¸ í‚¤(Primary Key)ë§¤í•‘](https://ttl-blog.tistory.com/123)\
[Spring Boot Data JPA 2.0 ì—ì„œ id Auto\_increment ë¬¸ì œ í•´ê²°](https://jojoldu.tistory.com/295)

\
\


### ğŸš´ğŸ½ JPAQueryFactory ì„¤ì • ì´ìŠˆ

> Spring boot 3.x, Querydsl 5.0.0, Java 17

\


**ì´ìŠˆì‚¬í•­**\
Spring Boot 3.x ë²„ì „ì—ì„œëŠ” javaxê°€ ì•„ë‹Œ `jakarta persistence dependency`ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ `build.gradle`ì„ ë³€ê²½í•˜ê³  EntityManager importë¥¼ ë³€ê²½ í›„ì— `JPAQueryFactory`ì— ë“±ë¡í–ˆìŒì—ë„ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•ŠëŠ” ëª¨ìŠµì„ ë³´ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.\
ì—¬ì „íˆ `JPAQueryFactory`ëŠ” javax entityë§Œì„ ìš”êµ¬í•˜ëŠ” ì´ìŠˆê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

![20230612\_192728.png](../assets/gitbook/post\_images/issue/20230612\_192728.png)

ì™œ jakartaë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•˜ì—¬\
ì˜¤ë¼í´ ì¬ë‹¨ì—ì„œ ì´í´ë¦½ìŠ¤ë¡œ `JavaEE` ê¸°ìˆ  ì´ì „ê³¼ í•¨ê»˜ ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ `javax.*` ëŒ€ì‹  ë‹¤ë¥¸ ëª…ì¹­ì¸ `jakarta.*`ë¥¼ ì‚¬ìš©í•˜ëŠ” `JakartaEE`ê°€ ë°˜ì˜ëœ Spring bootê°€ ë¦´ë¦¬ì¦ˆë˜ì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

\


**í•´ê²°ë°©ë²•**\
ë¨¼ì € Querydsl ì‚¬ìš©ì„ ìœ„í•œ ì„¤ì • ë¶€ë¶„ì„ ë³´ë©´, ë³€ê²½ëœ jakartaë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  implementaionì—ë„ jakartaë¥¼ ëª…ì‹œí•´ë‘ì—ˆìŠµë‹ˆë‹¤. ì´ ë¶€ë¶„ì€ ë¬¸ì œê°€ ì—†ê³  ë¹Œë“œë‚˜ Q class ìƒì„±ì—ë„ ì´ìƒì´ ì—†ì—ˆìŠµë‹ˆë‹¤.\
ì—ëŸ¬ë¥¼ ì‚´í´ë³´ë©´ EntityManager ì¸ì‹ë¬¸ì œê°€ ì œì¼ ì»¸ê¸° ë•Œë¬¸ì— [JPAQueryFactory](https://github.com/querydsl/querydsl/blob/master/querydsl-jpa/src/main/java/com/querydsl/jpa/impl/JPAQueryFactory.java)ê°€ ì™œ ì¸í…”ë¦¬ì œì´ì—ì„œ ì˜ì¡´ì„± ì£¼ì…ì´ ì œëŒ€ë¡œ ë˜ì§€ ì•Šì•˜ëŠ”ì§€ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤.

```yml
// querydsl
implementation "com.querydsl:querydsl-jpa:${queryDslVersion}:jakarta"
annotationProcessor "com.querydsl:querydsl-apt:${queryDslVersion}:jakarta"
annotationProcessor "jakarta.annotation:jakarta.annotation-api"
annotationProcessor "jakarta.persistence:jakarta.persistence-api"
```

ìœ„ì˜ ì½”ë“œì™€ ê°™ì´ `classifier`ë¡œ ë²„ì „ ë’¤ì— `:jakarta` ì„¤ì •ì„ í•´ì£¼ì§€ ì•Šì•„ ìƒê¸´ ë¬¸ì œì˜€ìŠµë‹ˆë‹¤. ì´ì „ ì½”ë“œì— `classifier`ë¥¼ ì¶”ê°€í•´ì£¼ì—ˆì§€ë§Œ, ì¸ì‹ì„ ì œëŒ€ë¡œ í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. gradle ë¹Œë“œ, clean, import ì¬ì‘ì„±, cache ì‚­ì œ ë“± ë°©ë²•ì„ ì‚¬ìš©í–ˆì§€ë§Œ í•´ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ê²°êµ­ build.gradle íŒŒì¼ì„ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ìƒì„±í•˜ëŠ” ê²ƒìœ¼ë¡œ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

[ì¸í…”ë¦¬ì œì´ ë¬¸ì˜](https://youtrack.jetbrains.com/issue/IDEA-255594/Intellij-keeps-old-dependencies)ì—ì„œë„ ì•Œ ìˆ˜ ìˆë“¯ì´ ê¾¸ì¤€íˆ ê°™ì€ ì´ìŠˆê°€ ë°œìƒí•˜ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì „ dependencyê°€ í”„ë¡œì íŠ¸ ë‚´ì— ì–´ë–¤ sourceì— ì˜í–¥ì„ ë¯¸ì¹˜ê³  ìˆê¸° ë•Œë¬¸ì¸ ê±¸ë¡œ ì¶”ì¸¡ë©ë‹ˆë‹¤.

> Facing issue with dependency ,as when removed/updated a dependency it still persisted with older version . Even Settings>Maven> Always update snapshots did not work here. Had to delete .idea and .iml files and reimport the project. Quite a lot of time and effort went into getting a workaround for this. This is a very basic use case where developers need to keep updating the maven dependencies. Having to spend time and money on ultimate edition seems wasteful at the moment.

ì´ë ‡ë‹¤ í•  ëšœë ·í•œ ëŒ€ì•ˆì€ ì—†ì§€ë§Œ IntelliJë¥¼ ë›°ì–´ë„˜ëŠ” íˆ´ë„ ì—†ê¸°ì— ì—¬ëŸ¬ ê°€ëŠ¥ì„±ì„ ë‘ê³  ì‚´í´ë³´ëŠ” ê²ƒì´ ì œì¼ ì¢‹ì€ ë°©ë²•ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

\


**ê²°ê³¼**\
`jakarta.persistence.EntityManager`ë¡œë„ `JPAQueryFactory` ë¹ˆ ì£¼ì… ë° ìƒì„±ì— ë¬¸ì œê°€ ì—†ìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. InitDB testë„ í†µê³¼í–ˆìŠµë‹ˆë‹¤! ì •ìƒì ì¸ ì‘ë™ì„ í™•ì¸í•œ ë’¤ì— ì½”ë“œë¥¼ ì‚´í´ë³´ë©´ java íŒŒì¼ì€ `javax`ë¥¼ ì—¬ì „íˆ ìš”êµ¬í•˜ê³  ìˆì§€ë§Œ class íŒŒì¼ ìƒì„±ì‹œì— `jakarta` íƒ€ì…ì˜ EntityManagerë¡œ ë°›ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![20230613\_150127.png](../assets/gitbook/post\_images/issue/20230613\_150127.png)

***

[ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0 ìœ¼ë¡œ ì „í™˜](https://post.dooray.io/we-dooray/tech-insight-ko/back-end/4173/)\
[spring boot 3.0](https://github.com/querydsl/querydsl/issues/3493)\
[Intellij keeps old dependencies](https://youtrack.jetbrains.com/issue/IDEA-255594/Intellij-keeps-old-dependencies)

\
\
